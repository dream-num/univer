# This workflow reuse lots of pieces from playwright.yml. It runs the visual-comparison tests and update snapshots.

name: ðŸ“¸ Update Snapshots

on:
    issue_comment:
        types: [created]

jobs:
    udpate-snapshots:
        runs-on: ubuntu-latest

        env:
            GH_TOKEN: ${{ github.token }}

        steps:
            - name: Checkout
              uses: actions/checkout@v4

            - name: Setup Node.js
              uses: ./.github/actions/setup-node

            - name: Install Playwright Browsers
              run: pnpm exec playwright install --with-deps chromium

            - name: Build E2E Client
              run: pnpm build:e2e

            - name: Update Snapshots
              run: pnpm exec playwright test --update-snapshots

            - name: Commit Updated Snapshots
              run: |
                  git config --global user.email "actions@github.com"
                  git config --global user.name "GitHub Actions"

                  git add -A
                  git commit -m "chore(snapshots): update snapshots" || exit 0
                  git push
